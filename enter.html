<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</head>
<body>
    <div>
        <h1>Create your chat room!</h1>
        <label>https://whispering-springs-32325.herokuapp.com/</label><input type="text" id="roomName" placeholder="room's name" /><input type="button" id="sub" onclick="createRoom()" value="enter" style="display:none;" />
        <h2 id="caution"></h2>
    </div>
    <script>
        var socket = io.connect();
        var rName
        function createRoom() {
            rName = document.getElementById("roomName").value;
            var loc = 'https://whispering-springs-32325.herokuapp.com/' + rName;
            socket.emit("sendRoomName", { value: rName});
            window.open(loc, '_blank');
            document.getElementById("sub").style.display = "none";
            document.getElementById("caution").textContent = "This room has already used！";
        }
        var roomForm = document.getElementById("roomName");
        roomForm.addEventListener("input", conf, false);
        function conf(e) {
            rName = document.getElementById("roomName").value;
            socket.emit("confRoomName", { value: rName});
            console.log("ask room");
        }
        socket.on("permit", function(data){
            console.log("return ans");
            console.log(data);
            if(data.value) {
                document.getElementById("sub").style.display = "block";
                document.getElementById("caution").textContent = "You can use this room！";
            }else {
                document.getElementById("sub").style.display = "none";
                document.getElementById("caution").textContent = "This room has already used！";
            }
        });
    </script>
</body>
</html>

